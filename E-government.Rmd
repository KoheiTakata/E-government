1. Digitalization

```{r setup, include = FALSE}
library(tidyverse)
```

```{r data, include = FALSE}
data_EGOV_ori <- read.csv("./data/EGOV_DATA.csv")
region_list   <- read.csv("./data/all.csv")

```

```{r regional_matching, include=FALSE}
region_list_sub <- region_list %>% 
                   select(name, region) %>% 
                   rename("Country" =  name)

data_EGOV_temp <- data_EGOV_ori %>% 
                  mutate(Country = ifelse(str_sub(Country.Name, start = -1, end = -1) == " ", #delete the last white space
                                          str_sub(Country.Name, start =  1, end = -2),
                                          Country.Name)) %>% 
                  left_join(region_list_sub, by = "Country")

# Na cleaning
no_match_list  <- unique(data_EGOV_temp$Country.Name[is.na(data_EGOV_temp$region)]) # countries with no match

#no_match_list

no_match_table <- data.frame(Country = no_match_list,
                             region = c("Asia", "Europe", "Americas", "Africa", "Europe",
                                        "Asia", "Africa", "Asia", "Americas", "Africa"))

# re-merge
data_EGOV <- data_EGOV_temp %>% 
             left_join(no_match_table, by = c("Country.Name" = "Country")) %>% 
             mutate(region = ifelse(is.na(region.x), region.y, region.x)) %>%
             select(-c(region.x, region.y))


#sum(is.na(data_EGOV$region)) #confirmation

```

```{r chart_1, echo= FALSE}
chart_1 <- data_EGOV %>% 
           filter(Survey.Year ==2020) %>% 
  ggplot(aes(y = E.Government.Index, color = region, fill = region, )) +
  #aes(x = stat(count)/sum(stat(count))) +
  geom_density(alpha = 1/10) +
  labs(title   = "Distribution of E-Government Index : 2020",
       x       = "Density",
       y       = "E-Government Index",
       caption = "Source: UN E-Government Development Index \n
                  Region is based on the UN.")
  
chart_1

#ggsave("chart_1.png", chart_1)
```
```{r chart_2, echo = FALSE}
data_EGOV_region <- read.csv("./data/EGOV_REGION_DATA_2020_EGDI.csv")

data_EGOV_region %>% 
  ggplot(aes(x = Region.or.Country, y = X2020.EGDI.Average))+
  geom_bar()

data_EGOV_region %>% 
      filter(Region.or.Country != "World") %>% 
      rename("Region" = Region.or.Country) %>% 
      ggplot(aes(x = Region, y = X2020.EGDI.Average,
                 color = Region, fill = Region))+
          geom_bar(stat ="identity", alpha = 5/10) +
          coord_flip()+
          labs(title  = "E-Government Index by Region: 2020",
               y      = "E-Government Index",
               x      = "Region",
              caption = "Source: UN E-Government Development Index \n
                         Region is based on the UN.") +
          geom_hline(aes(yintercept = 
                           data_EGOV_region$X2020.EGDI.Average[data_EGOV_region$Region.or.Country == "World"])) + 
          annotate("text", x=1, y=0.7, label= "World Average")
  ggsave(filename = "chart_2.png")

```
```{r }

```

